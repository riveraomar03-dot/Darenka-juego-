<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Juego para Darenka ðŸ’–</title>
<style>
  body{
    margin:0; min-height:100vh; display:grid; place-items:center;
    font-family: Arial, Helvetica, sans-serif;
    background: linear-gradient(135deg,#ff9a9e,#fad0c4);
  }
  .card{
    width:min(820px,94vw);
    background: rgba(255,255,255,.95);
    border-radius:22px;
    padding:28px;
    text-align:center;
    box-shadow:0 12px 35px rgba(0,0,0,.18);
    position:relative; overflow:hidden;
  }
  h1{margin:0 0 10px;font-size:34px}
  p{font-size:18px; line-height:1.35}
  .small{font-size:14px; opacity:.75}
  .btns{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:18px}
  button{
    border:0;border-radius:14px;padding:14px 20px;
    font-size:16px;font-weight:800;cursor:pointer;
    box-shadow:0 8px 18px rgba(0,0,0,.16);
    transition: transform .08s ease;
  }
  button:active{transform:scale(.98)}
  .primary{background:#111;color:#fff}
  .ghost{background:#fff;color:#111}
  .final{font-size:36px; margin-top:6px}
  .subfinal{font-size:18px; opacity:.9; margin-top:10px}
  .pill{
    display:inline-block;
    background:rgba(0,0,0,.06);
    padding:8px 12px;
    border-radius:999px;
    margin-top:10px;
    font-weight:700;
  }
  .heart{
    position:absolute;bottom:-20px;font-size:24px;
    animation: floatUp 3.2s ease forwards;pointer-events:none;
  }
  @keyframes floatUp{
    0%{transform:translateY(0) scale(.8);opacity:0}
    15%{opacity:1}
    100%{transform:translateY(-560px) scale(1.7);opacity:0}
  }
</style>
</head>

<body>
<div class="card" id="card">
  <h1 id="title">Hola Darenka ðŸ˜Š</h1>
  <p id="text">Antes de la sorpresaâ€¦ Â¿jugamos un poquito?</p>

  <div class="btns" id="btns">
    <button class="primary" id="musicBtn">Activar mÃºsica ðŸ’—</button>
    <button class="ghost" onclick="go(0)">Empezar ðŸŽ®</button>
  </div>

  <p class="small" id="hint">Tip: da un clic en cualquier parte y luego activa la mÃºsica ðŸ’—</p>

  <audio id="bgm" src="music.mp3" loop preload="auto" playsinline></audio>
</div>

<script>
const card = document.getElementById("card");
const title = document.getElementById("title");
const text = document.getElementById("text");
const btns = document.getElementById("btns");
const hint = document.getElementById("hint");
const bgm = document.getElementById("bgm");

/* ðŸ”“ Desbloqueo audio */
let audioUnlocked = false;
function unlockAudio(){
  if(audioUnlocked) return;
  bgm.muted = false;
  bgm.volume = 1.0;
  bgm.play().then(()=>{
    bgm.pause(); bgm.currentTime = 0;
    audioUnlocked = true;
  }).catch(()=>{});
}
document.addEventListener("click", unlockAudio, {once:true});
document.addEventListener("touchstart", unlockAudio, {once:true});

/* ðŸ’– corazones */
function hearts(amount=12){
  for(let i=0;i<amount;i++){
    const h = document.createElement("div");
    h.className = "heart";
    h.textContent = ["ðŸ’–","ðŸ’—","ðŸ’˜","ðŸ’","ðŸ’ž"][Math.floor(Math.random()*5)];
    h.style.left = (8 + Math.random()*84) + "%";
    h.style.fontSize = (18 + Math.random()*22) + "px";
    card.appendChild(h);
    setTimeout(()=>h.remove(), 3300);
  }
}
function confettiHearts(){
  hearts(22);
  setTimeout(()=>hearts(18), 250);
  setTimeout(()=>hearts(16), 550);
}

/* ðŸ§  contador de â€œromance pointsâ€ */
let points = 0;
function addPoints(n){
  points += n;
  // mini efecto visual
  hearts(6);
}

/* ðŸŽ® juego (mÃ¡s largo + romÃ¡ntico + Deftones) */
const steps = [
  {
    t:"Nivel 1 ðŸ’•",
    p:"Elige una puerta (prometo que las dos llevan a algo bonito):",
    choices:[
      {txt:"Puerta A ðŸšª", next:1, pts:1},
      {txt:"Puerta B ðŸšª", next:1, pts:1}
    ]
  },
  {
    t:"Nivel 2 âœ¨",
    p:"Elige un plan para una mini cita:",
    choices:[
      {txt:"CafÃ© â˜•", next:2, pts:2},
      {txt:"Helado ðŸ¦", next:2, pts:2},
      {txt:"Cine ðŸŽ¬", next:2, pts:2}
    ]
  },
  {
    t:"MisiÃ³n romÃ¡ntica ðŸ’Œ",
    p:"Si yo te regalo una canciÃ³n hoyâ€¦ Â¿quÃ© vibra elegirÃ­as?",
    choices:[
      {txt:"Suave y bonita ðŸŒ™", next:3, pts:2},
      {txt:"Intensa y real ðŸ”¥", next:3, pts:2},
      {txt:"Las dos ðŸ˜Œ", next:3, pts:3}
    ]
  },
  {
    t:"Trivia Deftones ðŸŽ¶",
    p:"Pregunta fÃ¡cil: Â¿QuiÃ©n es el vocalista de Deftones?",
    choices:[
      {txt:"Chino Moreno ðŸ–¤", next:4, pts:3},
      {txt:"El de la voz que pega en el pecho ðŸ˜®â€ðŸ’¨", next:4, pts:2}
    ]
  },
  {
    t:"Trivia Deftones ðŸŽ§",
    p:"Â¿CuÃ¡l de estos Ã¡lbumes es de Deftones?",
    choices:[
      {txt:"White Pony ðŸ¤ðŸŽ", next:5, pts:3},
      {txt:"El que suena como abrazo y tormenta a la vez ðŸŒ§ï¸", next:5, pts:2}
    ]
  },
  {
    t:"MisiÃ³n romÃ¡ntica ðŸ’ž",
    p:"Completa esto con un botÃ³n:\n\nâ€œContigo, lo simple se sienteâ€¦â€",
    choices:[
      {txt:"â€¦especial âœ¨", next:6, pts:3},
      {txt:"â€¦seguro ðŸ«¶", next:6, pts:3},
      {txt:"â€¦como hogar ðŸ¡", next:6, pts:4}
    ]
  },
  {
    t:"Trivia final ðŸ–¤",
    p:"Â¿CÃ³mo se siente escuchar Deftones?",
    choices:[
      {txt:"Emocional ðŸ–¤", next:7, pts:2},
      {txt:"Intenso ðŸ˜Œ", next:7, pts:2},
      {txt:"Como si te entendieran ðŸ”¥", next:7, pts:3}
    ]
  },
  {
    t:"Casiâ€¦ ðŸ˜³",
    p:"Okâ€¦ antes del final, una Ãºltima cosita:\n\nElige una promesa chiquita:",
    choices:[
      {txt:"Cuidarte ðŸ’—", next:8, pts:3},
      {txt:"Hacerte reÃ­r ðŸ¤", next:8, pts:3},
      {txt:"Elegirte cada dÃ­a ðŸ«¶", next:8, pts:4}
    ]
  },
  {
    t:"ðŸ’– Momento final",
    p:"Listoâ€¦ ya juntamos suficientes â€˜puntos de amorâ€™ ðŸ˜Œ",
    finalAsk:true
  }
];

function musicToggleButton(labelIndex){
  const b = document.createElement("button");
  b.className = "ghost";
  b.textContent = bgm.paused ? "ðŸ”Š MÃºsica ON" : "ðŸ”‡ MÃºsica OFF";
  b.onclick = () => {
    if (bgm.paused) bgm.play();
    else bgm.pause();
    go(labelIndex);
  };
  return b;
}

function go(i){
  const s = steps[i];
  title.textContent = s.t;

  // UI reset
  btns.innerHTML = "";
  hint.textContent = `Puntos de amor: ${points} ðŸ’–`;

  // pantalla final
  if (s.finalAsk){
    text.innerHTML = `
      <div class="pill">Puntos de amor: ${points} ðŸ’–</div>
      <div class="final">Darenka, Â¿quieres ser mi novia?</div>
      <div class="subfinal">No es un juegoâ€¦ pero sÃ­ es mi forma bonita de decirte que me importas ðŸ«¶</div>
    `;

    const yes = document.createElement("button");
    yes.className = "primary";
    yes.textContent = "SÃ­ ðŸ’•";
    yes.onclick = () => {
      confettiHearts();
      // mensaje romÃ¡ntico sin ser cursi extremo
      setTimeout(()=>{
        alert("ðŸ’– Me haces bien. Gracias por decir que sÃ­. ðŸ’–");
      }, 300);
    };

    const no = document.createElement("button");
    no.className = "ghost";
    no.textContent = "No ðŸ™ˆ";
    no.onmouseover = () => {
      no.style.transform =
        "translate("+(Math.random()*160-80)+"px,"+(Math.random()*60-30)+"px)";
    };

    btns.appendChild(musicToggleButton(i));
    btns.appendChild(yes);
    btns.appendChild(no);
    confettiHearts();
    return;
  }

  text.textContent = s.p;

  // mÃºsica on/off siempre disponible
  btns.appendChild(musicToggleButton(i));

  s.choices.forEach(c=>{
    const b = document.createElement("button");
    b.className = "primary";
    b.textContent = c.txt;
    b.onclick = () => {
      addPoints(c.pts || 0);
      go(c.next);
    };
    btns.appendChild(b);
  });
}

/* ðŸŽµ botÃ³n principal mÃºsica */
document.getElementById("musicBtn").onclick = async () => {
  if (!audioUnlocked){
    alert("Toca una vez la pantalla y vuelve a presionar ðŸ’—");
    return;
  }
  try{
    bgm.currentTime = 0;
    await bgm.play();
    hearts(10);
  }catch(e){
    alert("Sube el volumen o revisa que la pestaÃ±a no estÃ© en silencio ðŸ”Š");
  }
};
</script>
</body>
</html>
